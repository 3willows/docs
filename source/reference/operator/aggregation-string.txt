============================
String Aggregation Operators
============================

.. default-domain:: mongodb

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

.. |exp-has| replace:: String expressions, with the exception of
   :expression:`$concat`, only have

.. include:: /includes/intro-aggregation-string.rst

:expression:`$concat` behavior is well-defined regardless of the
characters used.

.. include:: /includes/extracts/operators-toc-explanation.rst

.. list-table::
   :widths: 30,70
   :header-rows: 1

   * - Name

     - Description

   * - :expression:`$concat`

     - Concatenates any number of strings.
   

   * - :expression:`$indexOfBytes`

     - Searches a string for an occurence of a substring and returns the
       UTF-8 byte index of the first occurence. If the substring is not
       found, returns ``-1``.
   

   * - :expression:`$indexOfCP`

     - Searches a string for an occurence of a substring and returns the
       UTF-8 code point index of the first occurence. If the
       substring is not found, returns ``-1``.
   

   * - :expression:`$split`

     - Splits a string into substrings based on a delimiter. Returns an
       array of substrings. If the delimiter is not found within the string,
       returns an array containing the original string.
   

   * - :expression:`$strLenBytes`

     - Returns the number of UTF-8 encoded bytes in a string.
   

   * - :expression:`$strLenCP`

     - Returns the number of UTF-8 `code points
       <http://www.unicode.org/glossary/#code_point>`_ in a string.
   

   * - :expression:`$strcasecmp`

     - Performs case-insensitive string comparison and returns: ``0`` if two
       strings are equivalent, ``1`` if the first string is greater than the
       second, and ``-1`` if the first string is less than the second.
   

   * - :expression:`$substr`

     - Deprecated. Use :expression:`$substrBytes` or :expression:`$substrCP`.
   

   * - :expression:`$substrBytes`

     - Returns the substring of a string. Starts with the
       character at the specified UTF-8 byte index (zero-based) in the string
       and continues for the specified number of bytes.
   

   * - :expression:`$substrCP`

     - Returns the substring of a string. Starts with the
       character at the specified UTF-8 `code point (CP)
       <http://www.unicode.org/glossary/#code_point>`_ index (zero-based)
       in the string and continues for the number of code points specified.
   

   * - :expression:`$toLower`

     - Converts a string to lowercase. Accepts a single argument expression.
   

   * - :expression:`$toUpper`

     - Converts a string to uppercase. Accepts a single argument expression.
   


.. toctree::
   :titlesonly: 
   :hidden: 

   /reference/operator/aggregation/concat
   /reference/operator/aggregation/indexOfBytes
   /reference/operator/aggregation/indexOfCP
   /reference/operator/aggregation/split
   /reference/operator/aggregation/strLenBytes
   /reference/operator/aggregation/strLenCP
   /reference/operator/aggregation/strcasecmp
   /reference/operator/aggregation/substr
   /reference/operator/aggregation/substrBytes
   /reference/operator/aggregation/substrCP
   /reference/operator/aggregation/toLower
   /reference/operator/aggregation/toUpper
